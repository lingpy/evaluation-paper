groundhog.library('ape')
library("groundhog")
library("groundhog")
pkgs <- c("mad.R","ape") # source the mad.R from the file
groundhog.library(pkgs, '2021-04-23')
# Load taxa annotation
tdf = read.csv('taxa-annotation.csv')
tdf$Newlabel<-apply(tdf, 1,function(x) paste0(x[1], ' [',x[4],']'))
# Load the newick trees and change the tip labels
loose = read.tree(file='looseid.nwk')
strict = read.tree(file='strictid.nwk')
Loose = unroot(loose)
Strict = unroot(strict)
Loose$tip.label= tdf[[5]][match(Loose$tip.label, tdf[[1]])]
Strict$tip.label= tdf[[5]][match(Strict$tip.label, tdf[[1]])]
# Compare unrooted Neighbor, save as a pdf
pdf(filename="plot/loose-strict-unroot.pdf")
comparePhylo(Loose, Strict, force.rooted=F, plot=T) #first figure
dev.off()
# Load taxa annotation
tdf = read.csv('taxa-annotation.csv')
getwd)
getwd()
setwd('../')
tdf = read.csv('taxa-annotation.csv')
tdf$Newlabel<-apply(tdf, 1,function(x) paste0(x[1], ' [',x[4],']'))
# Load the newick trees and change the tip labels
loose = read.tree(file='looseid.nwk')
strict = read.tree(file='strictid.nwk')
Loose = unroot(loose)
Strict = unroot(strict)
Loose$tip.label= tdf[[5]][match(Loose$tip.label, tdf[[1]])]
Strict$tip.label= tdf[[5]][match(Strict$tip.label, tdf[[1]])]
# Compare unrooted Neighbor, save as a png
png(filename="plot/loose-strict-unroot.png")
comparePhylo(Loose, Strict, force.rooted=F, plot=T) #first figure
dev.off()
library("groundhog")
pkgs <- c("dependencies/mad.R","ape") # source the mad.R from the file
groundhog.library(pkgs, '2021-04-23')
# Load taxa annotation
tdf = read.csv('taxa-annotation.csv')
tdf$Newlabel<-apply(tdf, 1,function(x) paste0(x[1], ' [',x[4],']'))
# Load the newick trees and change the tip labels
loose = read.tree(file='looseid.nwk')
strict = read.tree(file='strictid.nwk')
Loose = unroot(loose)
Strict = unroot(strict)
Loose$tip.label= tdf[[5]][match(Loose$tip.label, tdf[[1]])]
Strict$tip.label= tdf[[5]][match(Strict$tip.label, tdf[[1]])]
# Compare unrooted Neighbor, save as a png
png(filename="plot/loose-strict-unroot.png")
comparePhylo(Loose, Strict, force.rooted=F, plot=T) #first figure
dev.off()
pkgs <- c("dependencies/mad.R","ape") # source the mad.R from the file
groundhog.library(pkgs, '2021-04-23')
library("groundhog")
groundhog.library('ape', '2021-04-23')
source('dependencies/mad.R') # source the mad.R from the file
library("groundhog")
groundhog.day="2021-04-21"
groundhog.library('ape', groundhog.day)
source('dependencies/mad.R') # source the mad.R from the file
tdf = read.csv('taxa-annotation.csv')
tdf$Newlabel<-apply(tdf, 1,function(x) paste0(x[1], ' [',x[4],']'))
loose = read.tree(file='looseid.nwk')
strict = read.tree(file='strictid.nwk')
Loose = unroot(loose)
Strict = unroot(strict)
Loose$tip.label= tdf[[5]][match(Loose$tip.label, tdf[[1]])]
Strict$tip.label= tdf[[5]][match(Strict$tip.label, tdf[[1]])]
# Compare unrooted Neighbor, save as a png
png(filename="plot/loose-strict-unroot.png")
comparePhylo(Loose, Strict, force.rooted=F, plot=T) #first figure
dev.off()
loose = read.tree(file='results/looseid.nwk')
strict = read.tree(file='results/strictid.nwk')
Loose = unroot(loose)
Strict = unroot(strict)
Loose$tip.label= tdf[[5]][match(Loose$tip.label, tdf[[1]])]
Strict$tip.label= tdf[[5]][match(Strict$tip.label, tdf[[1]])]
png(filename="plot/loose-strict-unroot.png")
comparePhylo(Loose, Strict, force.rooted=F, plot=T) #first figure
dev.off()
pdf(filename="plot/loose-strict-unroot.pdf", paper=a4)
comparePhylo(Loose, Strict, force.rooted=F, plot=T) #first figure
dev.off()
pdf(file="plot/loose-strict-unroot.pdf", paper=a4)
comparePhylo(Loose, Strict, force.rooted=F, plot=T) #first figure
dev.off()
pdf(file="plot/loose-strict-unroot.pdf", paper='a4')
comparePhylo(Loose, Strict, force.rooted=F, plot=T) #first figure
dev.off()
pdf(file="plot/loose-strict-unroot.pdf", paper='a4r')
comparePhylo(Loose, Strict, force.rooted=F, plot=T) #first figure
dev.off()
pdf(file="plot/loose-strict-unroot.pdf", paper='a4r',width=7)
comparePhylo(Loose, Strict, force.rooted=F, plot=T) #first figure
dev.off()
pdf(file="plot/loose-strict-unroot.pdf", paper='a4r',width=7)
comparePhylo(Loose, Strict, force.rooted=F, plot=T) #first figure
dev.off()
pdf(file="plot/loose-strict-unroot.pdf", paper='a4r',width='90%')
comparePhylo(Loose, Strict, force.rooted=F, plot=T) #first figure
dev.off()
pdf(file="plot/loose-strict-unroot.pdf", paper='a4r', width = 8, height = 7)
comparePhylo(Loose, Strict, force.rooted=F, plot=T) #first figure
dev.off()
pdf(file="plot/loose-strict-unroot.pdf", paper='a4r', width = 10, height = 7)
comparePhylo(Loose, Strict, force.rooted=F, plot=T) #first figure
dev.off()
pdf(file="plot/loose-strict-unroot.pdf", paper='a4r', width = 12, height = 9)
comparePhylo(Loose, Strict, force.rooted=F, plot=T) #first figure
dev.off()
pdf(file="plot/loose-strict-unroot.pdf", paper='a4r', width = 15, height = 9)
comparePhylo(Loose, Strict, force.rooted=F, plot=T) #first figure
dev.off()
# Compare unrooted Neighbor, save as a png
pdf(file="plot/loose-strict-unroot.pdf", paper='a4r', width = 25, height = 9)
comparePhylo(Loose, Strict, force.rooted=F, plot=T) #first figure
dev.off()
pdf(file="plot/loose-strict-unroot.pdf",width = 20, height = 9)
comparePhylo(Loose, Strict, force.rooted=F, plot=T) #first figure
dev.off()
pdf(file="plot/loose-strict-unroot.pdf",width = 20, height = 9)
comparePhylo(Loose, Strict, force.rooted=F, plot=T) #first figure
dev.off()
pdf(file="plot/loose-strict-unroot.pdf",width = 15, height = 9)
comparePhylo(Loose, Strict, force.rooted=F, plot=T) #first figure
dev.off()
pdf(file="plot/loose-strict-unroot.pdf",width = 15, height = 7)
comparePhylo(Loose, Strict, force.rooted=F, plot=T) #first figure
dev.off()
pdf(file="plot/loose-strict-unroot.pdf",width = 15, height = 7)
comparePhylo(Loose, Strict, force.rooted=F, plot=T) # second figure
dev.off()
# MAD root
Loose_mad = as.phylo(mad(Loose, 'full')[[6]][[1]])
Strict_mad = as.phylo(mad(Strict, 'full')[[6]][[1]])
Loose_mad$tip.label = replace(Loose_mad$tip.label, Loose_mad$tip.label == "@#Nanjing [M]@#", "Nanjing [M]")
# replace the original Loose and Strict
Loose = Loose_mad
Strict = Strict_mad
# Compare MADrooted trees
pdf(file="plot/loose-strict-unroot.pdf",width = 15, height = 7)
comparePhylo(Loose, Strict, force.rooted=F, plot=T) # second figure
dev.off()
groundhog.library(c('ape', 'maps'), groundhog.day)
library("groundhog")
groundhog.day="2021-04-21"
groundhog.library(c('ape', 'maps'), groundhog.day)
source('dependencies/mad.R') # source the mad.R from the file
# Load taxa annotation
tdf = read.csv('taxa-annotation.csv')
tdf$Newlabel<-apply(tdf, 1,function(x) paste0(x[1], ' [',x[4],']'))
# Load the newick trees and change the tip labels
loose = read.tree(file='results/looseid.nwk')
strict = read.tree(file='results/strictid.nwk')
Loose = unroot(loose)
Strict = unroot(strict)
Loose$tip.label= tdf[[5]][match(Loose$tip.label, tdf[[1]])]
Strict$tip.label= tdf[[5]][match(Strict$tip.label, tdf[[1]])]
# Compare unrooted Neighbor, save as a png
pdf(file="plot/loose-strict-unroot.pdf",width = 15, height = 7)
comparePhylo(Loose, Strict, force.rooted=F, plot=T) #first figure
dev.off()
# MAD root
Loose_mad = as.phylo(mad(Loose, 'full')[[6]][[1]])
Strict_mad = as.phylo(mad(Strict, 'full')[[6]][[1]])
Loose_mad$tip.label = replace(Loose_mad$tip.label, Loose_mad$tip.label == "@#Nanjing [M]@#", "Nanjing [M]")
# replace the original Loose and Strict
Loose = Loose_mad
Strict = Strict_mad
# Compare MADrooted trees
pdf(file="plot/loose-strict-unroot.pdf",width = 15, height = 7)
comparePhylo(Loose, Strict, force.rooted=F, plot=T) # second figure
dev.off()
library("groundhog")
groundhog.day="2021-04-21"
groundhog.library(c('ape', 'maps'), groundhog.day)
source('dependencies/mad.R') # source the mad.R from the file
# Load taxa annotation
tdf = read.csv('taxa-annotation.csv')
tdf$Newlabel<-apply(tdf, 1,function(x) paste0(x[1], ' [',x[4],']'))
# Load the newick trees and change the tip labels
loose = read.tree(file='results/looseid.nwk')
strict = read.tree(file='results/strictid.nwk')
Loose = unroot(loose)
Strict = unroot(strict)
Loose$tip.label= tdf[[5]][match(Loose$tip.label, tdf[[1]])]
Strict$tip.label= tdf[[5]][match(Strict$tip.label, tdf[[1]])]
# Compare unrooted Neighbor, save as a png
pdf(file="plot/loose-strict-unroot.pdf",width = 15, height = 7)
comparePhylo(Loose, Strict, force.rooted=F, plot=T) #first figure
dev.off()
# MAD root
Loose_mad = as.phylo(mad(Loose, 'full')[[6]][[1]])
Strict_mad = as.phylo(mad(Strict, 'full')[[6]][[1]])
Loose_mad$tip.label = replace(Loose_mad$tip.label, Loose_mad$tip.label == "@#Nanjing [M]@#", "Nanjing [M]")
# replace the original Loose and Strict
Loose = Loose_mad
Strict = Strict_mad
# Compare MADrooted trees
pdf(file="plot/loose-strict-root.pdf",width = 15, height = 7)
comparePhylo(Loose, Strict, force.rooted=F, plot=T) # second figure
dev.off()
# Compare MADrooted trees
pdf(file="plot/loose-strict-root.pdf",width = 15, height = 10)
comparePhylo(Loose, Strict, force.rooted=F, plot=T) # second figure
dev.off()
pdf(file="plot/loose-strict-root.pdf",width = 15, height = 15)
comparePhylo(Loose, Strict, force.rooted=F, plot=T) # second figure
dev.off()
pdf(file="plot/loose-strict-root.pdf",width = 20, height = 15)
comparePhylo(Loose, Strict, force.rooted=F, plot=T) # second figure
dev.off()
